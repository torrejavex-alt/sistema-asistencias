import pandas as pd

# --- Fechas exactas (43 fechas) ---
fechas = [
    '2025-02-14', '2025-02-21', '2025-02-28',
    '2025-03-01', '2025-03-05', '2025-03-07', '2025-03-12', '2025-03-14',
    '2025-03-19', '2025-03-21', '2025-03-22', '2025-03-26', '2025-03-28', '2025-03-29',
    '2025-04-04', '2025-04-11', '2025-04-12', '2025-04-17', '2025-04-18',
    '2025-05-02', '2025-05-07', '2025-05-09', '2025-05-16', '2025-05-23', '2025-05-30',
    '2025-06-06', '2025-06-13', '2025-06-20',
    '2025-07-04', '2025-07-11', '2025-07-16', '2025-07-18', '2025-07-19', '2025-07-21',
    '2025-07-25', '2025-07-26', '2025-07-28',
    '2025-08-15', '2025-08-22',
    '2025-09-05', '2025-09-12', '2025-09-19', '2025-09-26'
]

n_fechas = len(fechas)  # 43

# --- Tus datos RAW tal como aparecen en la imagen ---
# Usamos: 
#   2  → Asistió
#   0  → Con permiso
#  -1  → No asistió
#   -  → No convocado → representado como None
datos_crudos = [
    ["Huberto Hernández", "Violín I", 2, 2, 2, 2, -1, 2, -1, 2, "-", 2, 2, 2, 2, 2, "-", 2, 2, "-", "-", -1, "-", 2, 2, -1, "-", 2, -1, 2, -1, -1, 2, 2, 0, 2, -1, 0, 2, -1, 2, 2, "-", "-", 2],
    ["Gabriel Chinchilla", "Violín I", 2, 2, 2, 2, 2, 2, 2, 2, "-", 2, 2, 2, 2, 2, 2, 2, 2, "-", "-", 0, "-", 0, 2, 2, "-", 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, "-", 0, 2, "-", "-", 2],
    ["Ninfa Montoya", "Violín I", 2, 2, 2, -1, 0, 2, 2, 2, "-", 2, 2, 2, 2, 2, "-", 0, 2, 2, 2, 2, "-", 0, 2, 2, "-", 0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 0, 0, 2, "-", "-", 2],
    ["Pedro Melgar", "Violín I", 0, 0, 2, 0, 0, 0, 0, 0, "-", 0, 0, 0, 0, 0, "-", 2, 2, "-", "-", 0, "-", 0, 0, 0, "-", -1, -1, 2, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, "-", "-", "-", 0],
    ["Lisseth Menéndez", "Violín I", -1, 2, 0, 0, 2, 2, 0, 0, "-", 2, 0, 2, 2, 2, "-", 0, 2, "-", "-", 0, "-", -1, 0, -1, "-", 2, 0, 2, 0, 0, 2, 0, 0, 2, 2, 0, 2, -1, 2, 2, "-", "-", 0],
    ["Kimberly Chacón", "Violín I", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", 2, 2, -1, "-", 0, 2, 2, 0, 2, 0, 0, 0, 0, 2, 0, 2, -1, -1, 0, "-", "-", 0],
    ["Violeta Quintanilla", "Violín II", 2, 2, 2, -1, 0, 2, 2, 2, "-", 2, 2, 2, 2, 2, "-", 0, 0, 2, 2, -1, "-", 2, 2, 2, "-", 2, 0, 2, 0, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, "-", "-", -1],
    ["Gustavo Oviedo", "Violín II", 0, 2, 2, 0, 0, 2, 2, 2, "-", 2, 2, 2, 2, 2, "-", 0, 2, 2, 2, 2, "-", 2, -1, -1, "-", 2, 2, 2, 0, 0, 2, 0, 0, 2, 2, 0, 2, 2, 2, 2, "-", "-", -1],
    ["Pedro Gómez", "Violín II", 2, 2, 2, 2, 2, 2, 2, 2, "-", 2, 2, 2, 2, 2, "-", 0, 0, 2, 2, 2, "-", 2, 2, 2, "-", 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, "-", "-", "-", 2],
    ["Alan Mendoza", "Violín II", "-", 2, -1, 2, -1, 0, -1, -1, "-", -1, -1, -1, 2, -1, "-", 0, 2, "-", "-", -1, "-", -1, -1, -1, "-", -1, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 2, 0, "-", "-", -1],
    ["Keyny Corpeño", "Violín II", "-", 2, 2, 2, -1, 2, 0, 0, "-", 2, 2, 0, 0, 0, "-", 0, 2, "-", "-", 0, "-", 2, 2, 0, "-", 0, 0, 2, 0, 0, 0, 2, 2, 2, 2, 0, 2, 0, -1, 0, "-", "-", -1],
    ["Fabricio Benítez", "Viola", 2, 2, 2, 0, 0, 0, 0, 2, "-", 2, 2, 2, 2, 2, "-", 2, 2, 2, 2, 2, "-", 2, 2, 2, "-", 2, 0, 2, 0, 0, 0, 2, 2, 2, 2, "-", 2, 0, "-", "-", "-", 2],
    ["Moises López", "Viola", -1, 2, -1, -1, -1, -1, 0, -1, "-", 2, 0, 2, 2, 2, "-", 0, 2, "-", "-", -1, "-", -1, -1, -1, "-", 2, 0, 0, 0, 0, 0, 0, 2, 2, 2, 0, 2, "-", -1, 0, "-", "-", -1],
    ["Gabriela Hernández", "Viola", "-", 2, 2, 2, 2, 2, 0, 0, "-", 2, 2, 2, 2, 2, "-", 0, 0, "-", "-", -1, "-", -1, 2, 2, "-", 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 0, 2, "-", 2, 2, "-", "-", 2],
    ["Daniela Hernández", "Violonchelo", 2, 2, 2, 2, -1, 2, 0, 0, "-", 2, 2, 2, 2, 2, "-", 2, 2, "-", "-", -1, "-", 2, 2, 2, "-", 2, 0, 2, 0, 0, 0, 0, 2, 2, 2, "-", 0, 0, "-", "-", "-", -1],
    ["Diego Cruz", "Violonchelo", 2, 2, 2, 2, -1, 2, 0, 2, "-", 2, 2, 2, 2, 2, "-", 0, 0, "-", "-", 2, "-", -1, "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", 2, 2, "-", "-", -1],
    ["Erick Alfaro", "Flauta", 2, 2, 2, "-", "-", 2, "-", 0, -1, 2, "-", "-", 0, "-", 2, "-", "-", 2, 2, "-", "-", -1, 2, 0, 2, 2, 2, 0, 2, 0, 2, "-", "-", 2, "-", 2, 2, 2, "-", 0, 2, -1, -1, -1],
    ["Liliana González", "Flauta", -1, -1, 2, "-", "-", -1, "-", -1, -1, 2, "-", "-", 0, "-", 2, "-", "-", "-", "-", "-", -1, -1, 0, 2, 0, -1, -1, "-", 0, 0, "-", "-", 0, "-", 2, 2, 2, "-", -1, 0, -1, -1, -1],
    ["Manuel Castellanos", "Corno Francés", 0, 2, 2, "-", "-", 2, "-", 0, 2, 2, "-", "-", 2, "-", 2, "-", "-", "-", "-", "-", 2, 2, 2, 2, 0, 2, 2, 2, 0, 2, "-", "-", 2, "-", 2, "-", 2, 0, -1, 2, 2],
    ["Gabriela Orellana", "Trompeta", 0, 2, 2, "-", "-", 2, "-", 0, 0, 2, "-", "-", 0, "-", 2, "-", "-", 2, 2, "-", "-", 2, 0, 0, 0, 0, 0, 0, "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", 0, 2, 2, 0, 2],
    ["Gerardo Núñez", "Trompeta", 2, 2, 2, "-", "-", 2, "-", 2, 2, 2, "-", "-", 2, "-", 0, "-", "-", 2, 2, "-", "-", 2, 2, 2, 0, 2, 0, 2, 0, 2, "-", "-", -1, "-", 2, "-", -1, 0, 0, 0, 0],
    ["Jovanne Portales", "Trompeta", 0, 2, -1, "-", "-", -1, "-", 2, -1, 2, "-", "-", 2, "-", -1, "-", "-", "-", "-", "-", 0, 2, 2, -1, 2, 2, -1, 2, 2, 2, "-", "-", -1, "-", 2, 1, 2, "-", 2, 2, -1, 2, 2],
    ["Julio García", "Trombón", 2, 2, 0, "-", "-", 2, "-", 2, -1, 2, "-", "-", 2, "-", 2, "-", "-", "-", "-", "-", 0, 2, 0, 0, 0, 0, -1, 0, 2, 0, "-", "-", 2, "-", 2, "-", 0, 2, -1, 0, 0]
]

# --- Convertir "-" a None y asegurar longitud ---
datos = []
for fila in datos_crudos:
    nombre = fila[0].strip()
    instrumento = fila[1].strip()
    valores = []
    for v in fila[2:]:
        if v == "-":
            valores.append(None)
        else:
            valores.append(v)
    # Asegurar 43 valores
    if len(valores) < n_fechas:
        valores += [None] * (n_fechas - len(valores))
    elif len(valores) > n_fechas:
        valores = valores[:n_fechas]
    datos.append([nombre, instrumento] + valores)

# --- Crear DataFrame y guardar ---
columnas = ['Nombre', 'Instrumento'] + fechas
df = pd.DataFrame(datos, columns=columnas)
df.to_excel('asistencias.xlsx', index=False)

print(f"✅ Archivo 'asistencias.xlsx' generado con {len(datos)} personas y {len(fechas)} fechas.")