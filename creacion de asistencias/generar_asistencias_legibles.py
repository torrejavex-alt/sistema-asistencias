import pandas as pd

# --- 43 fechas exactas ---
fechas = [
    '2025-02-14', '2025-02-21', '2025-02-28',
    '2025-03-01', '2025-03-05', '2025-03-07', '2025-03-12', '2025-03-14',
    '2025-03-19', '2025-03-21', '2025-03-22', '2025-03-26', '2025-03-28', '2025-03-29',
    '2025-04-04', '2025-04-11', '2025-04-12', '2025-04-17', '2025-04-18',
    '2025-05-02', '2025-05-07', '2025-05-09', '2025-05-16', '2025-05-23', '2025-05-30',
    '2025-06-06', '2025-06-13', '2025-06-20',
    '2025-07-04', '2025-07-11', '2025-07-16', '2025-07-18', '2025-07-19', '2025-07-21',
    '2025-07-25', '2025-07-26', '2025-07-28',
    '2025-08-15', '2025-08-22',
    '2025-09-05', '2025-09-12', '2025-09-19', '2025-09-26'
]

ESPERADO = len(fechas)  # 43

def codigo_a_texto(valor):
    if valor in ("2", 2):
        return "Asisti√≥"
    elif valor in ("0", 0):
        return "Con permiso"
    elif valor in ("-1", -1):
        return "No asisti√≥"
    else:
        return "No convocado"

# --- Datos crudos CORREGIDOS ---
# Se elimin√≥ el valor "1" extra en la fila de Jovanne Portales
datos_crudos = [
    ["Huberto Hern√°ndez", "Viol√≠n I", "2", "2", "2", "2", "-1", "2", "-1", "2", "-", "2", "2", "2", "2", "2", "-", "2", "2", "-", "-", "-1", "-", "2", "2", "-1", "-", "2", "-1", "2", "-1", "-1", "2", "2", "0", "2", "-1", "0", "2", "-1", "2", "2", "-", "-", "2"],
    ["Gabriel Chinchilla", "Viol√≠n I", "2", "2", "2", "2", "2", "2", "2", "2", "-", "2", "2", "2", "2", "2", "2", "2", "2", "-", "-", "0", "-", "0", "2", "2", "-", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "-", "0", "2", "-", "-", "2"],
    ["Ninfa Montoya", "Viol√≠n I", "2", "2", "2", "-1", "0", "2", "2", "2", "-", "2", "2", "2", "2", "2", "-", "0", "2", "2", "2", "2", "-", "0", "2", "2", "-", "0", "2", "2", "2", "2", "0", "2", "2", "2", "2", "2", "2", "0", "0", "2", "-", "-", "2"],
    ["Pedro Melgar", "Viol√≠n I", "0", "0", "2", "0", "0", "0", "0", "0", "-", "0", "0", "0", "0", "0", "-", "2", "2", "-", "-", "0", "-", "0", "0", "0", "-", "-1", "-1", "2", "0", "0", "0", "0", "0", "0", "2", "2", "0", "0", "-", "-", "-", "0"],
    ["Lisseth Men√©ndez", "Viol√≠n I", "-1", "2", "0", "0", "2", "2", "0", "0", "-", "2", "0", "2", "2", "2", "-", "0", "2", "-", "-", "0", "-", "-1", "0", "-1", "-", "2", "0", "2", "0", "0", "2", "0", "0", "2", "2", "0", "2", "-1", "2", "2", "-", "-", "0"],
    ["Kimberly Chac√≥n", "Viol√≠n I", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "2", "2", "-1", "-", "0", "2", "2", "0", "2", "0", "0", "0", "0", "2", "0", "2", "-1", "-1", "0", "-", "-", "0"],
    ["Violeta Quintanilla", "Viol√≠n II", "2", "2", "2", "-1", "0", "2", "2", "2", "-", "2", "2", "2", "2", "2", "-", "0", "0", "2", "2", "-1", "-", "2", "2", "2", "-", "2", "0", "2", "0", "2", "2", "2", "2", "2", "2", "0", "2", "2", "2", "2", "-", "-", "-1"],
    ["Gustavo Oviedo", "Viol√≠n II", "0", "2", "2", "0", "0", "2", "2", "2", "-", "2", "2", "2", "2", "2", "-", "0", "2", "2", "2", "2", "-", "2", "-1", "-1", "-", "2", "2", "2", "0", "0", "2", "0", "0", "2", "2", "0", "2", "2", "2", "2", "-", "-", "-1"],
    ["Pedro G√≥mez", "Viol√≠n II", "2", "2", "2", "2", "2", "2", "2", "2", "-", "2", "2", "2", "2", "2", "-", "0", "0", "2", "2", "2", "-", "2", "2", "2", "-", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "0", "2", "-", "-", "-", "2"],
    ["Alan Mendoza", "Viol√≠n II", "-", "2", "-1", "2", "-1", "0", "-1", "-1", "-", "-1", "-1", "-1", "2", "-1", "-", "0", "2", "-", "-", "-1", "-", "-1", "-1", "-1", "-", "-1", "0", "-1", "-1", "-1", "-1", "-1", "-1", "-1", "-1", "-1", "-1", "-1", "2", "0", "-", "-", "-1"],
    ["Keyny Corpe√±o", "Viol√≠n II", "-", "2", "2", "2", "-1", "2", "0", "0", "-", "2", "2", "0", "0", "0", "-", "0", "2", "-", "-", "0", "-", "2", "2", "0", "-", "0", "0", "2", "0", "0", "0", "2", "2", "2", "2", "0", "2", "0", "-1", "0", "-", "-", "-1"],
    ["Fabricio Ben√≠tez", "Viola", "2", "2", "2", "0", "0", "0", "0", "2", "-", "2", "2", "2", "2", "2", "-", "2", "2", "2", "2", "2", "-", "2", "2", "2", "-", "2", "0", "2", "0", "0", "0", "2", "2", "2", "2", "-", "2", "0", "-", "-", "-", "2"],
    ["Moises L√≥pez", "Viola", "-1", "2", "-1", "-1", "-1", "-1", "0", "-1", "-", "2", "0", "2", "2", "2", "-", "0", "2", "-", "-", "-1", "-", "-1", "-1", "-1", "-", "2", "0", "0", "0", "0", "0", "0", "2", "2", "2", "0", "2", "-", "-1", "0", "-", "-", "-1"],
    ["Gabriela Hern√°ndez", "Viola", "-", "2", "2", "2", "2", "2", "0", "0", "-", "2", "2", "2", "2", "2", "-", "0", "0", "-", "-", "-1", "-", "-1", "2", "2", "-", "2", "2", "2", "2", "2", "2", "0", "2", "2", "2", "0", "2", "-", "2", "2", "-", "-", "2"],
    ["Daniela Hern√°ndez", "Violonchelo", "2", "2", "2", "2", "-1", "2", "0", "0", "-", "2", "2", "2", "2", "2", "-", "2", "2", "-", "-", "-1", "-", "2", "2", "2", "-", "2", "0", "2", "0", "0", "0", "0", "2", "2", "2", "-", "0", "0", "-", "-", "-", "-1"],
    ["Diego Cruz", "Violonchelo", "2", "2", "2", "2", "-1", "2", "0", "2", "-", "2", "2", "2", "2", "2", "-", "0", "0", "-", "-", "2", "-", "-1", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "2", "2", "-", "-", "-1"],
    ["Erick Alfaro", "Flauta", "2", "2", "2", "-", "-", "2", "-", "0", "-1", "2", "-", "-", "0", "-", "2", "-", "-", "2", "2", "-", "-", "-1", "2", "0", "2", "2", "2", "0", "2", "0", "2", "-", "-", "2", "-", "2", "2", "2", "-", "0", "2", "-1", "-1", "-1"],
    ["Liliana Gonz√°lez", "Flauta", "-1", "-1", "2", "-", "-", "-1", "-", "-1", "-1", "2", "-", "-", "0", "-", "2", "-", "-", "-", "-", "-", "-1", "-1", "0", "2", "0", "-1", "-1", "-", "0", "0", "-", "-", "0", "-", "2", "2", "2", "-", "-1", "0", "-1", "-1", "-1"],
    ["Manuel Castellanos", "Corno Franc√©s", "0", "2", "2", "-", "-", "2", "-", "0", "2", "2", "-", "-", "2", "-", "2", "-", "-", "-", "-", "-", "2", "2", "2", "2", "0", "2", "2", "2", "0", "2", "-", "-", "2", "-", "2", "-", "2", "0", "-1", "2", "2"],
    ["Gabriela Orellana", "Trompeta", "0", "2", "2", "-", "-", "2", "-", "0", "0", "2", "-", "-", "0", "-", "2", "-", "-", "2", "2", "-", "-", "2", "0", "0", "0", "0", "0", "0", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "0", "2", "2", "0", "2"],
    ["Gerardo N√∫√±ez", "Trompeta", "2", "2", "2", "-", "-", "2", "-", "2", "2", "2", "-", "-", "2", "-", "0", "-", "-", "2", "2", "-", "-", "2", "2", "2", "0", "2", "0", "2", "0", "2", "-", "-", "-1", "-", "2", "-", "-1", "0", "0", "0", "0"],
    # üëá CORREGIDO: eliminado el "1" extra (ahora tiene 43 valores)
    ["Jovanne Portales", "Trompeta", "0", "2", "-1", "-", "-", "-1", "-", "2", "-1", "2", "-", "-", "2", "-", "-1", "-", "-", "-", "-", "-", "0", "2", "2", "-1", "2", "2", "-1", "2", "2", "2", "-", "-", "-1", "-", "2", "2", "-", "2", "2", "-1", "2", "2"],
    ["Julio Garc√≠a", "Tromb√≥n", "2", "2", "0", "-", "-", "2", "-", "2", "-1", "2", "-", "-", "2", "-", "2", "-", "-", "-", "-", "-", "0", "2", "0", "0", "0", "0", "-1", "0", "2", "0", "-", "-", "2", "-", "2", "-", "0", "2", "-1", "0", "0"]
]

# --- Asegurar que cada fila tenga exactamente 43 valores ---
datos_legibles = []
for i, fila in enumerate(datos_crudos):
    nombre = fila[0]
    instrumento = fila[1]
    valores = fila[2:]
    
    if len(valores) > ESPERADO:
        print(f"‚ö†Ô∏è  Fila {i+1} ({nombre}): {len(valores)} valores (m√°s de {ESPERADO}). Truncando.")
        valores = valores[:ESPERADO]
    elif len(valores) < ESPERADO:
        print(f"‚ö†Ô∏è  Fila {i+1} ({nombre}): {len(valores)} valores (menos de {ESPERADO}). Completando con '-'")
        valores = valores + ["-"] * (ESPERADO - len(valores))
    
    valores_texto = [codigo_a_texto(v) for v in valores]
    datos_legibles.append([nombre, instrumento] + valores_texto)

# --- Generar Excel ---
columnas = ['Nombre', 'Instrumento'] + fechas
df = pd.DataFrame(datos_legibles, columns=columnas)
df.to_excel('asistencias_legible.xlsx', index=False)

print(f"‚úÖ Archivo generado con {len(datos_legibles)} filas y {len(columnas)} columnas.")